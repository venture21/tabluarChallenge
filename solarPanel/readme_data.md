# 태양광 발전량 예측 데이터셋

## 개요
이 데이터셋은 **태양광 발전량 예측 대회**를 위한 것입니다. 목표는 기상 조건을 기반으로 **분위수 회귀**(9개 분위수: 10%, 20%, ..., 90%)를 사용하여 태양광 패널의 발전량을 예측하는 것입니다.

## 데이터 구조

### 학습 데이터 (`data/train/train.csv`)
- **총 레코드 수**: 52,560행 (헤더 제외)
- **시간 해상도**: 30분 간격
- **범위**: 여러 날의 연속 데이터

| 컬럼 | 설명 | 단위 |
|------|------|------|
| Day | 일 인덱스 (0부터 시작) | - |
| Hour | 시간 (0-23) | 시 |
| Minute | 분 (0 또는 30) | 분 |
| DHI | 산란일사량 (Diffuse Horizontal Irradiance) | W/m² |
| DNI | 직달일사량 (Direct Normal Irradiance) | W/m² |
| WS | 풍속 (Wind Speed) | m/s |
| RH | 상대습도 (Relative Humidity) | % |
| T | 기온 (Temperature) | °C |
| TARGET | 태양광 발전량 (예측 대상) | kW |

### 테스트 데이터 (`data/test/`)
- **총 파일 수**: 81개 파일 (0.csv ~ 80.csv)
- **구조**: 각 파일에는 7일간의 기상 데이터 포함
- **과제**: 각 테스트 파일에 대해 Day 7과 Day 8의 발전량 예측
- 학습 데이터와 동일한 컬럼 구조

### 샘플 제출 파일 (`data/sample_submission.csv`)
- **총 레코드 수**: 7,776행
- **형식**: 분위수 회귀 예측값

| 컬럼 | 설명 |
|------|------|
| id | 식별자 형식: `{파일명}_Day{일}_{시간}h{분}m` |
| q_0.1 | 10번째 백분위수 예측값 |
| q_0.2 | 20번째 백분위수 예측값 |
| q_0.3 | 30번째 백분위수 예측값 |
| q_0.4 | 40번째 백분위수 예측값 |
| q_0.5 | 50번째 백분위수 (중앙값) 예측값 |
| q_0.6 | 60번째 백분위수 예측값 |
| q_0.7 | 70번째 백분위수 예측값 |
| q_0.8 | 80번째 백분위수 예측값 |
| q_0.9 | 90번째 백분위수 예측값 |

## 특성 설명

### 일사량 특성
- **DHI (산란일사량)**: 하늘에서 받는 태양 복사 (직사광선 제외)
- **DNI (직달일사량)**: 표면에 수직으로 들어오는 직접 광선

### 기상 특성
- **WS (풍속)**: 패널 냉각 효율에 영향
- **RH (상대습도)**: 대기 투명도 및 패널 효율에 영향
- **T (기온)**: 높은 온도는 일반적으로 태양광 패널 효율을 감소시킴

## 주요 인사이트
1. **시간 기반 패턴**: 태양광 발전은 일별 주기를 따름 (야간에는 0, 정오 근처에서 최고점)
2. **계절적 변동**: 계절에 따라 기온과 일조 시간이 변함
3. **기상 의존성**: 구름(낮은 DHI/DNI)은 발전량을 크게 감소시킴
4. **분위수 예측**: 예측의 불확실성을 포착하여 전력망 관리에 중요

## 분위수 회귀 (Quantile Regression)

### 개념
분위수 회귀는 조건부 분포의 특정 분위수(백분위수)를 예측하는 회귀 기법입니다. 일반적인 회귀가 조건부 평균을 예측하는 것과 달리, 분위수 회귀는 예측값의 분포 전체를 모델링할 수 있습니다.

### 왜 분위수 회귀를 사용하는가?
1. **불확실성 정량화**: 단일 점 추정치 대신 예측 구간을 제공
2. **비대칭 분포 처리**: 정규 분포를 따르지 않는 데이터에 적합
3. **이상치 강건성**: 중앙값 회귀(q=0.5)는 평균 회귀보다 이상치에 덜 민감
4. **리스크 관리**: 최악/최선의 시나리오 예측 가능

### 손실 함수: 핀볼 손실 (Pinball Loss)
분위수 회귀는 **핀볼 손실(Pinball Loss)** 또는 **분위수 손실(Quantile Loss)** 을 최소화합니다:

```
L_τ(y, ŷ) = τ × max(y - ŷ, 0) + (1 - τ) × max(ŷ - y, 0)
```

여기서:
- `τ` (tau): 분위수 (예: 0.1, 0.5, 0.9)
- `y`: 실제값
- `ŷ`: 예측값

| 조건 | 손실 계산 |
|------|----------|
| 과소예측 (y > ŷ) | τ × (y - ŷ) |
| 과대예측 (y < ŷ) | (1 - τ) × (ŷ - y) |

**예시**: τ = 0.9 (90번째 백분위수)일 때
- 과소예측 페널티가 과대예측보다 9배 더 큼
- 모델이 더 높은 값을 예측하도록 유도

### 태양광 발전 예측에서의 활용
- **전력망 운영**: 발전량의 상한/하한 범위를 알면 백업 전력 계획 수립 가능
- **에너지 거래**: 불확실성을 고려한 입찰 전략 수립
- **저장 장치 관리**: 예상 범위에 따른 배터리 충방전 최적화

### 구현 방법
1. **LightGBM/XGBoost**: `objective='quantile'`, `alpha=τ` 설정
2. **sklearn**: `GradientBoostingRegressor(loss='quantile', alpha=τ)`
3. **딥러닝**: 커스텀 핀볼 손실 함수 구현

```python
# LightGBM 예시
import lightgbm as lgb

params = {
    'objective': 'quantile',
    'alpha': 0.5,  # 분위수 τ 값
    'metric': 'quantile',
}
model = lgb.train(params, train_data)
```

## 평가
- 분위수 회귀 예측 (9개 분위수)
- 핀볼 손실(Pinball Loss) 또는 유사한 분위수 기반 지표로 평가될 가능성 높음

## 모델링 접근 방식 권장사항
1. **특성 공학**: 시간 기반 특성, 지연 특성, 롤링 통계
2. **모델**: 분위수 목적 함수를 사용한 LightGBM, XGBoost, CatBoost
3. **검증**: 데이터 누수 방지를 위한 시계열 교차 검증
